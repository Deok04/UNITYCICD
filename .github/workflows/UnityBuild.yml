name: UnityBuildTest

on:
  workflow_dispatch:  # ì´ ì´ë²¤íŠ¸ íŠ¸ë¦¬ê±°ëŠ” ìˆ˜ë™ ì‹¤í–‰ì„ í—ˆìš©í•©ë‹ˆë‹¤.

permissions:
  contents: read
  id-token: write
  issues: write

jobs:
  buildForAndroid:
    name: Build AndroidğŸ›¸ğŸ›¸ğŸ›¸
    runs-on: ubuntu-latest  # ê°€ì¥ ìµœì‹ ì˜ Ubuntu ê°€ìƒ í™˜ê²½ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤.

    steps:
      - name: Check Out Code
        uses: actions/checkout@v4  # GitHub ì €ì¥ì†Œì—ì„œ ì½”ë“œë¥¼ ì²´í¬ì•„ì›ƒí•©ë‹ˆë‹¤.
        with:
          fetch-depth: 0  # ëª¨ë“  ì´ë ¥ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
          lfs: true  # Git Large File Storageë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.

      - name: Cache Library
        uses: actions/cache@v4.0.2  # Unity ë¼ì´ë¸ŒëŸ¬ë¦¬ ìºì‹œë¥¼ ì„¤ì •í•©ë‹ˆë‹¤.
        with:
          path: Library
          key: Library-${{ hashFiles('Assets/**', 'Packages/**', 'ProjectSettings/**') }}
          restore-keys: |
            Library-

      - name: Unity Build
        uses: game-ci/unity-builder@v4  # Unity ë¹Œë“œë¥¼ ìˆ˜í–‰í•©ë‹ˆë‹¤.
        env:
          UNITY_SERIAL: ${{ secrets.UNITY_SERIAL }}  # GitHub Secretsì—ì„œ Unity ì‹œë¦¬ì–¼ ë²ˆí˜¸ë¥¼ ê°€ì ¸ì˜µë‹ˆë‹¤.
        with:
          targetPlatform: Android  # íƒ€ê²Ÿ í”Œë«í¼ì€ Androidë¡œ ì„¤ì •í•©ë‹ˆë‹¤.

      - name: Upload Build File
        uses: actions/upload-artifact@v3  # ë¹Œë“œ íŒŒì¼ì„ ì•„í‹°íŒ©íŠ¸ë¡œ ì—…ë¡œë“œí•©ë‹ˆë‹¤.
        with:
          name: Build-Android
          path: build

